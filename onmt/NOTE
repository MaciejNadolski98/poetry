Module adapted from https://github.com/OpenNMT/OpenNMT-py
